<!-- floatingButtons.html -->
<style>
  /* æ‚¬æµ®æŒ‰é’®æ•´ä½“å®¹å™¨ */
  #floating-buttons {
    position: fixed;
    bottom: 20px;
    right: 20px;
    z-index: 9999;
    display: flex;
    flex-direction: column;
    align-items: flex-end;
    gap: 15px;
  }
  /* å…¬å…±æŒ‰é’®æ ·å¼ï¼ˆé»‘è‰²ç£¨ç ‚ç»ç’ƒæ•ˆæœï¼‰ */
  .float-btn button {
    width: 50px;
    height: 50px;
    border-radius: 50%;
    border: 1px solid rgba(255, 255, 255, 0.2);
    background: rgba(0, 0, 0, 0.3);
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
    color: #fff;
    font-size: 18px;
    cursor: pointer;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.5);
    transition: background-color 0.3s, transform 0.3s;
    display: flex;             /* æ–°å¢ï¼šé‡‡ç”¨ flex å¸ƒå±€ */
    align-items: center;       /* æ–°å¢ï¼šå‚ç›´å±…ä¸­ */
    justify-content: center;   /* æ–°å¢ï¼šæ°´å¹³å±…ä¸­ */
  }
  .float-btn button:hover {
    background: rgba(0, 0, 0, 0.5);
    transform: scale(1.05);
  }
  /* è¯­è¨€åˆ‡æ¢æŒ‰é’®å®¹å™¨ï¼šç›¸å¯¹äº .lang-btn å®šä½ */
  .lang-btn {
    position: relative;
  }
  /* è¯­è¨€é€‰é¡¹å®¹å™¨ï¼šç›¸å¯¹äº .lang-btn å®šä½ï¼Œåˆå§‹çŠ¶æ€ä¸‹éšè— */
  .lang-options {
    position: absolute;
    left: 0;
    top: 50%;
  }
  /* è¯­è¨€é€‰é¡¹æŒ‰é’®ï¼šåˆå§‹é‡å åœ¨ä¸»æŒ‰é’®ä¸­å¿ƒï¼Œéšè—ï¼ˆscale:0ï¼Œopacity:0ï¼‰ */
  .lang-option {
    position: absolute;
    left: 50%;
    top: 50%;
    transform: translate(-50%, -50%) scale(0);
    opacity: 0;
    transition: transform 0.4s ease, opacity 0.4s ease;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    border: 1px solid rgba(255, 255, 255, 0.2);
    background: rgba(0, 0, 0, 0.3);
    backdrop-filter: blur(8px);
    -webkit-backdrop-filter: blur(8px);
    color: #fff;
    font-size: 14px;
    cursor: pointer;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.5);
  }
  .lang-option:hover {
    background: rgba(0, 0, 0, 0.5);
    transform: scale(1.1);
  }
  /* å½“å‰æ¿€æ´»çŠ¶æ€ï¼šé‡‡ç”¨é‡‘è‰²è¾¹æ¡†ä¸æ–‡å­—æç¤º */
  .lang-option.active {
    background: rgba(0, 0, 0, 0.8);
    border: 1px solid #ff914d;
    color: #ff914d;
    font-weight: bold;
  }
  /* æ˜¾ç¤ºçŠ¶æ€æ—¶ï¼Œè®¾ç½®ä¸¤ä¸ªé€‰é¡¹çš„ç›®æ ‡ä½ç½®ï¼š
     - top-option å‘ä¸Šåç§» 40px
     - bottom-option å‘ä¸‹åç§» 40px
     åŒæ—¶æ°´å¹³é£å‡º 60pxï¼ˆå³ calc(-100% - 10px)ï¼‰ */
  .lang-options.show .top-option {
    transform: translate(calc(-100% - 10px), calc(-50% - 40px)) scale(1);
    opacity: 1;
    pointer-events: auto;
  }
  .lang-options.show .bottom-option {
    transform: translate(calc(-100% - 10px), calc(-50% + 40px)) scale(1);
    opacity: 1;
    pointer-events: auto;
  }
</style>

<div id="floating-buttons">
  <!-- è¯­è¨€åˆ‡æ¢æŒ‰é’® -->
  <div class="float-btn lang-btn">
    <button id="toggle-lang-options" title="åˆ‡æ¢è¯­è¨€">ğŸŒ</button>
    <div class="lang-options" id="lang-options">
      <button class="lang-option top-option" data-lang="zh" title="ä¸­æ–‡">ä¸­</button>
      <button class="lang-option bottom-option" data-lang="en" title="English">EN</button>
    </div>
  </div>
  <!-- å›åˆ°é¡¶éƒ¨æŒ‰é’® -->
  <div class="float-btn top-btn">
    <button id="back-to-top" title="å›åˆ°é¡¶éƒ¨">â†‘</button>
  </div>
</div>

<script>
  (function() {
  // è¯­è¨€åˆ‡æ¢éƒ¨åˆ†
  var toggleLangOptions = document.getElementById("toggle-lang-options");
  var langOptions = document.getElementById("lang-options");
  var langOptionButtons = document.querySelectorAll(".lang-option");

  // ç‚¹å‡»ä¸»æŒ‰é’®æ—¶ï¼Œåˆ‡æ¢æ˜¾ç¤ºçŠ¶æ€ï¼ˆå¸¦åŠ¨ç”»æ•ˆæœï¼‰
  toggleLangOptions.addEventListener("click", function() {
    langOptions.classList.toggle("show");
  });

  // ç‚¹å‡»å…·ä½“è¯­è¨€æŒ‰é’®æ—¶ï¼Œä½¿ç”¨ i18next åˆ‡æ¢è¯­è¨€
  langOptionButtons.forEach(function(btn) {
    btn.addEventListener("click", function() {
      var selectedLang = this.getAttribute("data-lang");
      i18next.changeLanguage(selectedLang, function(err, t) {
        if(err) {
          console.error(err);
          return;
        }
        localStorage.setItem("lang", selectedLang);
        document.documentElement.lang = selectedLang;
        // è°ƒç”¨å…¨å±€ updateContent() æ›´æ–°é¡µé¢æ–‡æœ¬
        if (typeof updateContent === "function") {
          updateContent();
        }
        // æ›´æ–° active æ ·å¼
        langOptionButtons.forEach(function(b) {
          b.classList.remove("active");
        });
        btn.classList.add("active");
        console.log("Language switched to: " + selectedLang);
      });
      // éšè—è¯­è¨€é€‰é¡¹
      langOptions.classList.remove("show");
    });
  });

  // åˆå§‹åŒ–æ—¶ï¼Œæ ¹æ® localStorage çš„è®¾ç½®æ›´æ–° active æ ·å¼
  var currentLang = localStorage.getItem("lang") || "en";
  document.documentElement.lang = currentLang;
  langOptionButtons.forEach(function(btn) {
    if (btn.getAttribute("data-lang") === currentLang) {
      btn.classList.add("active");
    } else {
      btn.classList.remove("active");
    }
  });

  // å›åˆ°é¡¶éƒ¨æŒ‰é’®éƒ¨åˆ†
  var backToTop = document.getElementById("back-to-top");
  backToTop.addEventListener("click", function() {
    window.scrollTo({ top: 0, behavior: "smooth" });
  });
})();
</script>